---
import Layout from "../layouts/layout.astro";
import Navigation from "../components/Navigation.astro";
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

// Get all press articles and sort by date
const pressArticles = await getCollection('press');
const sortedArticles = pressArticles.sort((a: CollectionEntry<'press'>, b: CollectionEntry<'press'>) => 
  b.data.publishedAt.valueOf() - a.data.publishedAt.valueOf()
);

// Get featured article (marked as featured or most recent)
const featuredArticle = sortedArticles.find((article: CollectionEntry<'press'>) => article.data.featured) || sortedArticles[0];
const otherArticles = sortedArticles.filter((article: CollectionEntry<'press'>) => article.id !== featuredArticle.id);

// Icon mapping for SVG paths
const iconPaths: Record<string, string> = {
  dollar: "M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",
  layers: "M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5",
  chart: "M9 11H3v10h6V11zM15 3H9v18h6V3zM21 7h-6v14h6V7z",
  rocket: "M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z",
  brain: "M12 2a9 9 0 0 0-9 9c0 1.5.4 3 1 4.3l2 3.7 6-4 6 4 2-3.7c.6-1.3 1-2.8 1-4.3a9 9 0 0 0-9-9z",
  meeting: "M3 18 L8 13 L13 16 L18 8 L21 13"
};

function formatDate(date: Date): string {
  return date.toLocaleDateString('en-US', { 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric' 
  });
}
---

<Layout title="Press - Zabaca">
	<main class="zabaca-inspired">
		<Navigation activePage="press" />

		<!-- Hero wrapper with pink background -->
		<div class="hero-wrapper">
			<div class="press-hero">
				<h1>Press</h1>
				<p>Latest news and announcements from Zabaca</p>
			</div>
		</div>

		<!-- Press list section -->
		<div class="press-list-section">
			<div class="container">
				{featuredArticle && (
					<!-- Featured press release -->
					<article class="featured-release">
						<a href={`/press/${featuredArticle.id.replace('.md', '')}`} class="release-link">
							<div class="release-image">
								<div class="placeholder-image" style={`background: ${featuredArticle.data.icon?.gradient || 'linear-gradient(135deg, #4ff37d, #2de05a)'};`}>
									<svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
										{featuredArticle.data.icon?.type === 'meeting' && (
											<>
												<path d="M3 18 L8 13 L13 16 L18 8 L21 13" />
												<circle cx="8" cy="13" r="1.5" fill="white"/>
												<circle cx="13" cy="16" r="1.5" fill="white"/>
												<circle cx="18" cy="8" r="1.5" fill="white"/>
											</>
										)}
										{featuredArticle.data.icon?.type !== 'meeting' && (
											<path d={iconPaths[featuredArticle.data.icon?.type || 'rocket']} />
										)}
									</svg>
								</div>
							</div>
							<div class="release-content">
								<div class="release-meta">
									<span class="release-date">{formatDate(featuredArticle.data.publishedAt)}</span>
									<span class="release-tag">{featuredArticle.data.category}</span>
								</div>
								<h2>{featuredArticle.data.title}</h2>
								<p>{featuredArticle.data.description}</p>
								<span class="read-more">Read more â†’</span>
							</div>
						</a>
					</article>
				)}

				<!-- Grid of other press releases -->
				<div class="releases-grid">
					{otherArticles.map((article: CollectionEntry<'press'>) => (
						<article class="release-card">
							<a href={`/press/${article.id.replace('.md', '')}`} class="release-link">
								<div class="release-image">
									<div class="placeholder-image" style={`background: ${article.data.icon?.gradient || 'linear-gradient(135deg, #4ff37d, #2de05a)'};`}>
										<svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
											<path d={iconPaths[article.data.icon?.type || 'rocket']} />
										</svg>
									</div>
								</div>
								<div class="release-content">
									<div class="release-meta">
										<span class="release-date">{formatDate(article.data.publishedAt)}</span>
										<span class="release-tag">{article.data.category}</span>
									</div>
									<h3>{article.data.title}</h3>
									<p>{article.data.description}</p>
								</div>
							</a>
						</article>
					))}
				</div>
			</div>
		</div>

		<!-- Newsletter section -->
		<div class="newsletter-section">
			<div class="newsletter-container">
				<h2>Stay updated</h2>
				<p>Get the latest Zabaca news delivered to your inbox</p>
				<form class="newsletter-form">
					<input type="email" placeholder="Enter your email" class="email-input" required />
					<button type="submit" class="subscribe-button">Subscribe</button>
				</form>
			</div>
		</div>
	</main>
</Layout>

<style>
	/* Import web fonts */
	@import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&display=swap');
	
	/* Modern design base styles */
	.zabaca-inspired {
		font-family: 'Fredoka', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
		color: #131416;
		font-weight: 400;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
	}

	/* Hero wrapper with pink background */
	.hero-wrapper {
		background-color: #ff00b8;
		padding-top: 120px;
		padding-bottom: 80px;
		position: relative;
		border-bottom-left-radius: 50% 120px;
		border-bottom-right-radius: 50% 120px;
	}

	.press-hero {
		text-align: center;
		max-width: 800px;
		margin: 0 auto;
		padding: 0 2rem;
		position: relative;
		z-index: 1;
	}

	.press-hero h1 {
		font-size: 4rem;
		font-weight: 700;
		color: white;
		margin-bottom: 1rem;
		letter-spacing: -0.02em;
	}

	.press-hero p {
		font-size: 1.25rem;
		color: rgba(255, 255, 255, 0.9);
	}

	/* Press list section */
	.press-list-section {
		padding: 4rem 0;
		background: white;
		position: relative;
	}

	.container {
		max-width: 1200px;
		margin: 0 auto;
		padding: 0 2rem;
	}

	/* Featured release */
	.featured-release {
		margin-bottom: 3rem;
		transform: rotate(-0.5deg);
		transition: transform 0.3s ease;
	}

	.featured-release:hover {
		transform: rotate(0deg) scale(1.02);
	}

	.featured-release .release-link {
		display: flex;
		gap: 2rem;
		background: white;
		border-radius: 24px;
		overflow: hidden;
		text-decoration: none;
		color: inherit;
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
	}

	.featured-release .release-image {
		flex: 0 0 40%;
		position: relative;
		min-height: 300px;
	}

	.featured-release .placeholder-image {
		position: absolute;
		inset: 0;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.featured-release .placeholder-image svg {
		width: 80px;
		height: 80px;
		opacity: 0.9;
	}

	.featured-release .release-content {
		flex: 1;
		padding: 2.5rem;
		display: flex;
		flex-direction: column;
		justify-content: center;
	}

	.release-meta {
		display: flex;
		align-items: center;
		gap: 1rem;
		margin-bottom: 1rem;
	}

	.release-date {
		font-size: 0.875rem;
		color: #666;
		font-weight: 500;
	}

	.release-tag {
		background: #4ff37d;
		color: #131416;
		padding: 0.25rem 0.75rem;
		border-radius: 100px;
		font-size: 0.75rem;
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}

	.featured-release h2 {
		font-size: 2rem;
		font-weight: 700;
		line-height: 1.2;
		margin-bottom: 1rem;
		color: #131416;
	}

	.featured-release p {
		font-size: 1.125rem;
		line-height: 1.6;
		color: #666;
		margin-bottom: 1.5rem;
	}

	.read-more {
		font-weight: 600;
		color: #131416;
		display: inline-flex;
		align-items: center;
		transition: transform 0.2s ease;
	}

	.featured-release:hover .read-more {
		transform: translateX(4px);
	}

	/* Grid of releases */
	.releases-grid {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
		gap: 2rem;
	}

	.release-card {
		transform: rotate(-0.5deg);
		transition: transform 0.3s ease;
	}

	.release-card:nth-child(even) {
		transform: rotate(0.5deg);
	}

	.release-card:hover {
		transform: rotate(0deg) scale(1.02);
	}

	.release-card .release-link {
		display: block;
		background: white;
		border-radius: 16px;
		overflow: hidden;
		text-decoration: none;
		color: inherit;
		box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
		transition: all 0.3s ease;
	}

	.release-card:hover .release-link {
		box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
	}

	.release-card .release-image {
		position: relative;
		height: 200px;
		overflow: hidden;
	}

	.release-card .placeholder-image {
		width: 100%;
		height: 100%;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.release-card .placeholder-image svg {
		width: 48px;
		height: 48px;
		opacity: 0.9;
	}

	.release-card .release-content {
		padding: 1.5rem;
	}

	.release-card h3 {
		font-size: 1.25rem;
		font-weight: 600;
		line-height: 1.3;
		margin-bottom: 0.75rem;
		color: #131416;
	}

	.release-card p {
		font-size: 1rem;
		line-height: 1.5;
		color: #666;
	}

	/* Newsletter section */
	.newsletter-section {
		background-color: #ffdc00;
		padding: 4rem 0;
		margin-top: 4rem;
		border-top-left-radius: 50% 80px;
		border-top-right-radius: 50% 80px;
	}

	.newsletter-container {
		max-width: 600px;
		margin: 0 auto;
		padding: 0 2rem;
		text-align: center;
	}

	.newsletter-section h2 {
		font-size: 2.5rem;
		font-weight: 700;
		color: #131416;
		margin-bottom: 1rem;
		font-family: 'Fredoka', sans-serif;
	}

	.newsletter-section p {
		font-size: 1.125rem;
		color: #131416;
		margin-bottom: 2rem;
		font-family: 'Fredoka', sans-serif;
	}

	.newsletter-form {
		display: flex;
		gap: 1rem;
		justify-content: center;
		align-items: center;
		flex-wrap: wrap;
	}

	.email-input {
		background: white;
		border: 2px solid #131416;
		border-radius: 100px;
		padding: 14px 24px;
		font-size: 16px;
		font-family: 'Fredoka', sans-serif;
		min-width: 300px;
		outline: none;
		transition: all 0.3s ease;
	}

	.email-input:focus {
		box-shadow: 0 0 0 3px rgba(19, 20, 22, 0.1);
	}

	.email-input::placeholder {
		color: #999;
	}

	.subscribe-button {
		background-color: #131416;
		color: white;
		border: none;
		padding: 14px 32px;
		border-radius: 100px;
		font-weight: 600;
		font-size: 16px;
		cursor: pointer;
		transition: all 0.3s ease;
		font-family: 'Fredoka', sans-serif;
	}

	.subscribe-button:hover {
		transform: scale(1.05);
		box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
	}

	/* Responsive design */
	@media (max-width: 768px) {
		.press-hero h1 {
			font-size: 3rem;
		}

		.featured-release .release-link {
			flex-direction: column;
		}

		.featured-release .release-image {
			flex: none;
			height: 200px;
		}

		.featured-release .release-content {
			padding: 1.5rem;
		}

		.featured-release h2 {
			font-size: 1.5rem;
		}

		.releases-grid {
			grid-template-columns: 1fr;
		}

		.newsletter-form {
			flex-direction: column;
			align-items: stretch;
		}

		.email-input {
			min-width: 100%;
			width: 100%;
		}

		.subscribe-button {
			width: 100%;
		}
	}
</style>